<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Inventory Management System</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background:linear-gradient(135deg,rgb(220, 223, 236) 0%,rgb(42, 51, 183) 100%);
                min-height: 100vh;
                padding: 20px;
            }

            .container {
                max-width: 1200px;
                margin: 0 auto;
                background: white;
                border-radius: 15px;
                box-shadow: 0 20px 40px rgba(0,0,0,0.1);
                overflow: hidden;
            }

            .header {
                background: linear-gradient(135deg, rgb(193, 195, 205) 0%,rgb(42, 51, 183) 100%);
                color: white;
                padding: 30px;
                text-align: center;
            }
            
            .header h1 {
                font-size: 2.5em;
                margin-bottom: 10px;
            }

            .nav-tab {
                flex: 1;
                padding: 15px 20px;
                background: none;
                border: none;
                cursor: pointer;
                font-size: 16px;
                transition: all 0.3s;
            }

            .nav-tab.active {
                background: white;
                border-bottom: 3px solid rgb(42, 51, 183);
                font-weight: bold;
            }

            .tab-content {
                padding: 30px;
            }
            
            .tab-pane {
                display: none;
            }

            .tab-pane.active {
                display: block;
            }

            .stats-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 20px;
                margin-bottom: 30px;
            }

            .stat-card {
                background: linear-gradient(135deg, rgb(220, 223, 236) 0%,rgb(42, 51, 183) 100%);
                color: white;
                padding: 25px;
                border-radius: 10px;
                text-align: center;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>Beer Inventory System</h1>
            </div>
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showTab('dashboard')">Dashboard</button>
                <button class="nav-tab" onclick="showTab('products')">Products</button>
                <button class="nav-tab" onclick="showTab('brands')">Brands</button>
                <button class="nav-tab" onclick="showTab('stock')">Stock Management</button>
            </div>

            <div class="tab-content">
                <!-- Dashboard Tab -->
                <div id="dashboard" class="tab-pane active">
                    <h2>Inventory Overview</h2>
                    <div class="stats-grid" id="statsGrid">
                        <!-- Stats will load here -->
                    </div>

                    <h3>Low Stock Items</h3>
                    <div class="table-container">
                        <table id="lowStockTable">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Brand</th>
                                    <th>Current Stock</th>
                                    <th>Price</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Low stock items will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Products Tab -->
                <div id="products" class="tab-pane">
                    <h2>Product Management</h2>
                    <div class="form-group">
                        <button class="btn" onclick="showAddProductForm()">Add New Product</button>
                    </div>

                    <!-- Add Product Form -->
                    <div id="addProductForm" style="display: none; background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom:20px;">
                        <h3>Add New Product</h3>
                        <form id="productForm">
                            <div class="form-group">
                                <label>Product Name:</label>
                                <input type="text" id="productName" required>
                            </div>
                            <div class="form-group">
                                <label>SKU:</label>
                                <input type="text" id="productSku" required>
                            </div>
                            <div class="form-group">
                                <label>Brand:</label>
                                <select id="productBrand" required>
                                    <!-- Brands will be loaded here -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Package Size:</label>
                                <input type="text" id="productPackageSize" placeholder="e.g., 12 Pack">
                            </div>
                            <div class="form-group">
                                <label>Price:</label>
                                <input type="number" id="productPrice" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label>Type:</label>
                                <input type="text" id="productType" placeholder="e.g., Lager, Stout">
                            </div>
                            <div class="form-group">
                                <label>ABV (%):</label>
                                <input type="number" id="productAbv" step="0.1" placeholder="e.g., 5.0">
                            </div>
                            <div class="form-group">
                                <label>Initial Stock:</label>
                                <input type="number" id="productStock" required>
                            </div>
                            <button type="submit" class="btn">Save Product</button>
                            <button type="button" class="btn btn-danger" onclick="hideAddProductForm()">Cancel</button>
                        </form>
                    </div>

                    <div class="table-container">
                        <table id="productsTable">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>SKU</th>
                                    <th>Brand</th>
                                    <th>Package</th>
                                    <th>Price</th>
                                    <th>Type</th>
                                    <th>ABV</th>
                                    <th>Stock</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Products will load here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Brands Tab -->
                <div id="brands" class="tab-pane">
                    <h2>Brand Management</h2>
                    
                    <div class="form-group">
                        <button class="btn" onclick="showAddBrandForm()">Add New Brand</button>
                    </div>
                    
                    <!-- Add Brand Form -->
                    <div id="addBrandForm" style="display: none; background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <h3>Add New Brand</h3>
                        <form id="brandForm">
                            <div class="form-group">
                                <label>Brand Name:</label>
                                <input type="text" id="brandName" required>
                            </div>
                            <div class="form-group">
                                <label>Country:</label>
                                <input type="text" id="brandCountry" required>
                            </div>
                            <div class="form-group">
                                <label>Description:</label>
                                <input type="text" id="brandDescription" placeholder="Brief description of the brand">
                            </div>
                            <button type="submit" class="btn">Save Brand</button>
                            <button type="button" class="btn btn-danger" onclick="hideAddBrandForm()">Cancel</button>
                        </form>
                    </div>
                    
                    <div class="table-container">
                        <table id="brandsTable">
                            <thead>
                                <tr>
                                    <th>Brand Name</th>
                                    <th>Country</th>
                                    <th>Description</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Brands will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Stock Management Tab -->
                <div id="stock" class="tab-pane">
                    <h2>Stock Management</h2>
                    <div class="table-container">
                        <table id="stockTable">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Brand</th>
                                    <th>Current Stock</th>
                                    <th>Price</th>
                                    <th>Stock Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Stock management will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <script>
            const API_BASE = 'http://localhost:5000/api';

            // Tab switching
            function showTab(tabName) {
                // Hide all tab panes
                document.querySelectorAll('.tab-pane').forEach(pane => {
                    pane.classList.remove('active');
                });

                // Remove active class from all tabs
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.classList.remove('active')
                })

                // Show selected tab pane
                document.getElementById(tabName).classList.add('active')

                // Add active class to clicked tab
                event.target.classList.add('active')

                // Load data for the tab
                if (tabName === 'dashboard') {
                    loadDashboard();
                } else if (tabName === 'products') {
                    loadProducts()
                    loadBrandsForSelect()
                } else if (tabName === 'brands') {
                    loadBrands()
                } else if (tabName === 'stock') {
                    loadStockManagement()
                }
            }

            // Dashboard functions
            async function loadDashboard() {
                try {
                    const [summaryResponse, lowStockResponse] = await Promise.all([
                        fetch(`${API_BASE}/inventory/summary`),
                        fetch(`${API_BASE}/products/low-stock`)
                    ])

                    const summary = await summaryResponse.json()
                    const lowStockItems = await lowStockResponse.json()

                    // Update stats
                    document.getElementById('statsGrid').innerHTML = `
                        <div class="stat-card">
                            <div class="stat-number">${summary.total_products}</div>
                            <div class="stat-label">Total Products</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">${summary.total_brands}</div>
                            <div class="stat-label">Total Brands</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">${summary.total_stock_value}</div>
                            <div class="stat-label">Total Stock Value</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">${summary.low_stock_items}</div>
                            <div class="stat-label">Low Stock Items</div>
                        </div>
                    `

                    // Update low stock table
                    const lowStockTableBody = document.querySelector('#lowStockTable tbody')
                    lowStockTableBody.innerHTML = lowStockItems.map(item => `
                        <tr>
                            <td>${item.name}</td>
                            <td>${item.brand?.name || 'N/A'}</td>
                            <td><span class="low-stock">${item.stock}</span></td>
                            <td>$${item.price}</td>
                        </tr>
                    `).join('')
                } catch (error) {
                    console.error('Error loading dashboard:', error)
                }
            }

            // Product functions
            


            // Initialize dashboard on page load
            window.onload = function() {
                loadDashboard()
            }
        </script>
    </body>
</html>